<!doctype html>     //只能支持IE浏览器
<html>
 <head>
	<meta charset="utf-8">
	<title>Document</title>
	<script language="javascript">
		function query()
		{
			var ss = (window.ActiveXObject) ? "此浏览器支持ActiveXObject" : "此浏览器不支持ActiveXObject";
 
			//alert(navigator.appVersion);
 
			var xx = document.getElementById("support");
 
			var a = ( navigator.appVersion+";").split(";");
 
			xx.innerHTML = "浏览器名称：" + navigator.appName  +"<br>" + 
			               "浏览器平台：" + navigator.platform +"<br>" +
			               "浏览器版本：" + a[1].replace("MS","") + "<br>"+
						   "<br><b>"+ss+"</b><br><br>";
 
			var o = new ActiveXObject("Scripting.FileSystemObject");
			var od = o.GetDrive("E");
			xx.innerHTML += ("E盘的卷名称是：" + od.VolumeName);
            
			//连接数据库
			var db = new ActiveXObject("ADODB.Connection");
			db.open("Provider=SQLOLEDB.1;Data Source=127.0.0.1;User ID=sa;Password=1234;Initial Catalog=Test");
 
			var rs = db.Execute("select * from tb");
			var c = rs.Fields.Count-1;
            
			//拼接表的字段名称
			var str = "<table border=1><tr>";
			for(var i = 0; i <=c; i++)
			{	
				str += "<td>" + rs.Fields(i).Name + "</td>";
			}
 
			str += "</tr>";
 
            //拼接表的数据
			while(!rs.EOF)
			{
				str += "<tr>";
				for(var i = 0;i <= c; i++)
				{
					str += "<td>" + rs.Fields(i).Value + "</td>";
				}
				str += "</tr>";
 
				rs.moveNext();
			}
 
			str += "</table>";
			
			var yy = document.getElementById("sp");
			yy.innerHTML = str;
 
			rs.Close();
			db.Close();
		}
	</script>	
 </head>
 
 <body >
    <input type="button" onclick="query()" value="查询SQL Server 2014的Test数据库的tb表数据">
	<p>
		<span id="support"></span>
		<hr><br>
		<span id="sp"></span>
	</p>
 
 
 </body>
</html>
